<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Main Effects & Interaction Plots</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/plotly.js-dist-min"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.11.0/math.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: white;
      color: black;
      padding: 20px;
    }

    .plot-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
    }

    canvas {
      background-color: white;
    }

    #contourPlot {
      width: 100%;
      height: 400px;
      background-color: white;
    }

    h2 {
      margin-bottom: 10px;
    }

    .chart-container {
      background-color: white;
    }
  </style>
</head>
<body>
  <h2>DOE Plots - Styled Like Your Original</h2>

  <div class="plot-grid">
    <div class="chart-container"><canvas id="mainEffectX1"></canvas></div>
    <div class="chart-container"><canvas id="mainEffectX2"></canvas></div>
    <div class="chart-container"><canvas id="interactionX1"></canvas></div>
    <div class="chart-container"><canvas id="interactionX2"></canvas></div>
  </div>

  <h2>Contour Plot</h2>
  <div id="contourPlot"></div>

  <script>
    const coeffs = [3, 1, 2, 0.5]; // b0, b1, b2, b12

    const x = [-1, 1];

    function calculateY(x1, x2) {
      return coeffs[0] + coeffs[1] * x1 + coeffs[2] * x2 + coeffs[3] * x1 * x2;
    }

    const yMainX1 = x.map(x1 => calculateY(x1, 0));
    const yMainX2 = x.map(x2 => calculateY(0, x2));
    const yIntX1_low = x.map(x1 => calculateY(x1, -1));
    const yIntX1_high = x.map(x1 => calculateY(x1, 1));
    const yIntX2_low = x.map(x2 => calculateY(-1, x2));
    const yIntX2_high = x.map(x2 => calculateY(1, x2));

    const chartOptions = (title, minY, maxY) => ({
      responsive: true,
      plugins: {
        title: { display: true, text: title, color: "#000" },
        legend: { labels: { color: "#000" } }
      },
      scales: {
        x: { ticks: { color: "#000" }, grid: { color: "#ccc" } },
        y: {
          min: minY,
          max: maxY,
          ticks: { color: "#000" },
          grid: { color: "#ccc" }
        }
      }
    });

    const yMin = Math.min(...yMainX1, ...yMainX2, ...yIntX1_low, ...yIntX1_high, ...yIntX2_low, ...yIntX2_high) - 1;
    const yMax = Math.max(...yMainX1, ...yMainX2, ...yIntX1_low, ...yIntX1_high, ...yIntX2_low, ...yIntX2_high) + 1;

    new Chart("mainEffectX1", {
      type: "line",
      data: {
        labels: x,
        datasets: [{
          label: "Y vs X1 (X2=0)",
          data: yMainX1,
          borderColor: "#000",
          fill: false
        }]
      },
      options: chartOptions("Main Effect: X1", yMin, yMax)
    });

    new Chart("mainEffectX2", {
      type: "line",
      data: {
        labels: x,
        datasets: [{
          label: "Y vs X2 (X1=0)",
          data: yMainX2,
          borderColor: "#444",
          fill: false
        }]
      },
      options: chartOptions("Main Effect: X2", yMin, yMax)
    });

    new Chart("interactionX1", {
      type: "line",
      data: {
        labels: x,
        datasets: [
          { label: "X2 = -1", data: yIntX1_low, borderColor: "#000", fill: false },
          { label: "X2 = +1", data: yIntX1_high, borderColor: "#888", fill: false }
        ]
      },
      options: chartOptions("Interaction: Y vs X1", yMin, yMax)
    });

    new Chart("interactionX2", {
      type: "line",
      data: {
        labels: x,
        datasets: [
          { label: "X1 = -1", data: yIntX2_low, borderColor: "#000", fill: false },
          { label: "X1 = +1", data: yIntX2_high, borderColor: "#888", fill: false }
        ]
      },
      options: chartOptions("Interaction: Y vs X2", yMin, yMax)
    });

    const xRange = math.range(-1, 1.01, 0.05).toArray();
    const yRange = math.range(-1, 1.01, 0.05).toArray();
    const z = yRange.map(y => xRange.map(x => calculateY(x, y)));

    Plotly.newPlot('contourPlot', [{
      z: z,
      x: xRange,
      y: yRange,
      type: 'contour',
      colorscale: 'Viridis',
      contours: { coloring: 'heatmap', showlabels: true }
    }], {
      title: 'Contour Plot of Y(X1, X2)',
      xaxis: { title: 'X1', scaleanchor: 'y' },
      yaxis: { title: 'X2' },
      margin: { t: 30 }
    }, { responsive: true });
  </script>
</body>
</html>
